# Nixpacks configuration for Railway deployment
# See: https://nixpacks.com/docs/configuration/file

[phases.setup]
nixPkgs = [
    "nodejs_20",
    "ruby_3_3",
    "imagemagick",
    "ffmpeg",
    "vips"
]
aptPkgs = ["pdftk", "wkhtmltopdf"]

[phases.install]
cmds = [
    "bundle install",
    "npm install"
]

[phases.build]
cmds = [
    "bundle exec rails assets:precompile"
]

[start]
cmd = "bundle exec puma -C config/puma.rb"
